<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <!-- 모바일 기기에서 올바른 화면 비율을 위한 뷰포트 설정 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>학습 분석 리포트 - 이미소 학생</title>

    <!-- Tailwind CSS CDN 로드 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- D3.js 및 D3 Word Cloud 라이브러리 로드 -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/jasondavies/d3-cloud@v1.2.7/build/d3.layout.cloud.js"></script>
    
    <!-- Google Fonts (Inter, Noto Sans KR) 로드 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* 기본 바디 스타일 및 폰트 설정 */
        body {
            font-family: 'Noto Sans KR', 'Inter', sans-serif;
            background-color: #f9fafb; /* 부드러운 회색 배경 */
            color: #1f2937; /* 가독성 높은 텍스트 색상 */
            -webkit-font-smoothing: antialiased; /* 폰트 렌더링 최적화 */
            -moz-osx-font-smoothing: grayscale;
        }
        /* 섹션 카드 공통 스타일 */
        .section-card {
            background-color: white;
            border-radius: 0.75rem; /* 12px */
            padding: 1.5rem; /* 24px */
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
            margin-bottom: 1.5rem; /* 24px */
        }

        /* 인쇄 시 스타일 조정 */
        @media print {
            body {
                background-color: #ffffff;
                color: #000000;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            .section-card {
                box-shadow: none;
                border: 1px solid #e5e7eb;
                margin-bottom: 1rem;
                padding: 1rem;
            }
            .chart-container, .word-cloud-container {
                page-break-inside: avoid;
            }
            footer { display: none; }
        }
        
        /* 진도 분석 그리드 스타일 */
        .progress-grid {
            display: grid;
            gap: 0.5rem;
            text-align: center;
            font-size: 0.875rem;
            color: #374151;
        }
        .grid-cell {
            background-color: #f3f4f6;
            border-radius: 0.5rem;
            padding: 0.75rem 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 500;
            position: relative;
            transition: background-color 0.3s ease;
        }
        .grid-header {
            background-color: #e5e7eb;
            font-weight: 700;
            color: #1f2937;
        }
        /* 나의 진도 표시 */
        .me-icon {
            position: absolute;
            top: 0.25rem;
            left: 0.25rem;
            background-color: #ef4444; /* red-500 */
            color: white;
            font-size: 0.625rem;
            font-weight: 700;
            padding: 0.1rem 0.3rem;
            border-radius: 0.375rem;
        }
        /* 상위권 경로 표시 */
        .top-tier-path {
            border: 2px solid #facc15; /* yellow-400 */
            box-shadow: 0 0 0 2px rgba(250, 204, 21, 0.5);
        }
        /* 탭 버튼 스타일 */
        .tab-button {
            padding: 0.75rem 1.5rem;
            border-bottom: 3px solid transparent;
            font-weight: 600;
            color: #6b7280;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
        }
        .tab-button.active {
            border-color: #4f46e5;
            color: #4f46e5;
        }
        /* 워드 클라우드 텍스트 스타일 */
        .word-cloud-text {
            cursor: pointer;
            transition: transform 0.2s ease-out, filter 0.2s ease-out;
        }
        .word-cloud-text:hover {
            transform: scale(1.1);
            filter: brightness(1.2);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>

    <main class="max-w-3xl mx-auto p-4 md:p-6">
        <!-- Report Title and Period Section -->
        <div class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800">이미소 학생 월간 리포트</h1>
            <p class="text-md md:text-lg text-gray-500 mt-2">2025년 7월 학습 분석</p>
            <div class="mt-3 text-sm text-gray-400">
                <p>분석 기간: 2025년 7월 1일 ~ 7월 31일</p>
            </div>
        </div>
        
        <!-- D-Day Section -->
        <section class="section-card p-4">
            <div class="flex-grow mb-4">
                <p class="text-gray-700 text-m md:text-base leading-relaxed">
                    뜨거운 여름 햇살 아래, 한 학기를 성실히 마무리한 아이의 모습이 더욱 반짝입니다. <strong>7월, 그동안의 여정을 되돌아보며 미소 학생을 향한 격려와 응원을 담아보았습니다.</strong><br>
                </p>
            </div>
        </section>
        <!-- 7월의 성장 -->
        <section class="section-card">
            <h2 class="text-xl font-bold mb-3 text-indigo-600">🚀 7월의 성장</h2>
            <p class="text-gray-600 mb-4">
                6월에 비해 <strong class="text-gray-800">개념강의 수강 후 핵심 키워드 평가를 85% 응시하면서, 배운 내용을 복습하는 습관이 탄탄해졌습니다.</strong><br><br>
                또한 <strong class="text-gray-800">이달의 스윗타임 별 보상은 총 77개로 지난 달에 비해 2배가 넘습니다. 학습 계획 달성, 집중, 예약 시간 출석 등 자기주도학습 습관이 잘 자라고 있습니다.</strong><br><br>
                미소 학생에게 많은 칭찬과 응원을 보내주세요. 💪
            </p>
            <div id="word-cloud-container" class="relative w-full h-48 sm:h-56 md:h-64 mx-auto">
                <!-- Word cloud will be generated by JavaScript -->
            </div>
        </section>

        <!-- Detailed Analysis by Subject -->
        <h2 class="text-2xl font-bold mb-4 mt-10 text-center text-gray-800">과목별 학습 상세</h2>

        <!-- Science -->
        <div class="science-cards-container">
            <div class="section-card">
                <h3 class="text-xl font-bold text-gray-800 mb-3">🔬 과학</h3>
                <div class="space-y-4">
                    <div><p class="text-sm text-gray-600 mt-1">2단원의 <strong class="text-red-500">'기권과 지구 기온'</strong> 부분을 수강하며 기권은 대류권, 성층권, 중간권, 열권으로 나뉘며, 각 층은 기온 변화와 특징이 다름을 알고, 완전학습평가를 통해 복습 학습까지 완료하였습니다.</p></div>
                    <div><p class="text-sm text-gray-600 mt-1"><strong class="text-blue-600">지구의 평균 기온을 높이는 온실 효과와 온실 기체의 역할은 서술형으로 자주 출제됩니다.</strong></p></div>
                </div>
            </div>
            <div id="collapsible-science-cards" style="display: none;">
                <div class="section-card"><div class="space-y-4"><div><p class="text-sm text-gray-600 mt-1">2단원의 <strong class="text-red-500">'구름과 강수'</strong> 내용을 수강하며 구름이 수증기의 응결로 형성된다는 원리와 구름의 생성 과정과 날씨 변화에 대해 배웠고, 완전학습평가를 통해 복습 학습하였습니다.</p></div><div><p class="text-sm text-gray-600 mt-1"><strong class="text-blue-600">구름의 종류에 따라 어떤 형태의 강수가 발생하는지와 상승 기류와의 연관성은 학생들이 특히 구분을 어려워하는 부분입니다.</strong></p></div></div></div>
                <div class="section-card"><div class="space-y-4"><div><p class="text-sm text-gray-600 mt-1">2단원의 <strong class="text-red-500">'기압과 바람'</strong>에서 바람이 기압이 높은 곳에서 낮은 곳으로 이동한다는 기본 원리와 바람의 방향과 세기를 이해하였고, 완전학습평가를 통해 복습 학습까지 완료하였습니다.</p></div><div><p class="text-sm text-gray-600 mt-1"><strong class="text-blue-600">등압선이 촘촘할수록 바람이 세다는 개념은 지도와 함께 출제될 수 있으며, 많은 학생들이 어려워하는 부분입니다.</strong></p></div></div></div>
                <div class="section-card"><div class="space-y-4"><div><p class="text-sm text-gray-600 mt-1">2단원의 <strong class="text-red-500">'날씨의 변화'</strong> 부분에서 기온, 기압, 바람, 습도 등이 시간에 따라 변화하면서 날씨를 결정한다는 개념을 학습했고, 완전학습평가를 통해 복습 학습까지 완료하였습니다.</p></div><div><p class="text-sm text-gray-600 mt-1"><strong class="text-blue-600">한랭 전선과 온난 전선이 통과할 때 나타나는 날씨 변화와 구름의 종류는 개념이 복잡하고 그림을 통해 자주 출제되는 부분입니다.</strong></p></div></div></div>
            </div>
        </div>
        <div class="flex justify-center -mt-4 mb-4"><button id="toggle-science-button" class="text-indigo-600 hover:text-indigo-800 font-semibold text-sm py-2 px-4">더 보기 ▼</button></div>

        <!-- Learning Path Recommendation -->
        <h2 class="text-2xl font-bold mb-4 mt-10 text-center text-gray-800">학습 방향 추천</h2>
        
        <div class="section-card">
            <!-- Tab Buttons -->
            <div class="border-b border-gray-200">
                <nav id="subject-tabs" class="flex -mb-px" aria-label="Tabs">
                    <button data-tab="math" class="tab-button active">
                        <span class="text-2xl mr-2">📊</span> 수학 진도 분포
                    </button>
                    <button data-tab="english" class="tab-button">
                        <span class="text-2xl mr-2">📈</span> 영어 레벨 분포
                    </button>
                </nav>
            </div>

            <!-- Tab Content -->
            <div class="mt-6">
                <!-- Math Content -->
                <div id="math-content" class="tab-content active">
                    <div class="flex flex-wrap justify-between items-center mb-4 gap-4">
                        <div class="flex items-center flex-wrap gap-x-4 gap-y-2 text-sm">
                            <div class="flex items-center"><span class="w-4 h-4 rounded-sm bg-blue-200 mr-2 flex-shrink-0"></span><span>동학년 분포</span></div>
                            <div class="flex items-center"><span class="w-4 h-4 rounded-sm border-2 border-yellow-500 mr-2 flex-shrink-0"></span><span>상위권 주요 진도</span></div>
                        </div>
                    </div>
                    <div id="math-progress-grid" class="progress-grid" style="grid-template-columns: 80px repeat(4, 1fr);"></div>
                    <div class="text-left text-xs text-gray-400 mt-2">*상위권: 동학년 목표달성장학생 수강 현황<br>*진도를 터치하면 동학년의 주요 진도를 확인할 수 있습니다.</div>
                    <div class="bg-purple-50 border border-purple-200 rounded-lg p-6 mt-6">
                        <h4 class="font-bold text-lg text-purple-800">💡 특목/자사고 합격자의 수학 학습 TIP</h4>
                        <p class="mt-3 text-sm text-purple-700">
                            <strong>특목/자사고에 합격한 엠베스트 회원들의 수학 학습 패턴을 분석한 결과, 현재 진도를 심화 강좌로 복습</strong>하는 경우가 대다수였고, <strong>심화 강좌를 개념 강좌와 동시에 학습</strong>하는 경우도 많았습니다.<br><br>
                            또한 <strong>학기별 연계성이 강한 수학 특성상, 다음 학년의 내용을 미리 공부</strong>하는 비중도 높았습니다. (예시: 1학년 2학기와 2학년 2학기 학습 병행)<br><br>
                            미소 학생의 수학 실력을 더욱 탄탄히 다지기 위해 필요한 강좌 혹은 추가 학습에 대해 함께 이야기 나누어 보시면 좋을 것 같습니다. 😎
                        </p>
                    </div>
                </div>

                <!-- English Content -->
                <div id="english-content" class="tab-content">
                    <div class="flex flex-wrap justify-between items-center mb-4 gap-4">
                        <div class="flex items-center flex-wrap gap-x-4 gap-y-2 text-sm">
                            <div class="flex items-center"><span class="w-4 h-4 rounded-full bg-red-500 mr-2 flex-shrink-0"></span><span>나의 레벨</span></div>
                            <div class="flex items-center"><span class="w-4 h-4 rounded-sm bg-blue-200 mr-2 flex-shrink-0"></span><span>동학년 분포</span></div>
                            <div class="flex items-center"><span class="w-4 h-4 rounded-sm border-2 border-yellow-500 mr-2 flex-shrink-0"></span><span>상위권 주요 레벨</span></div>
                        </div>
                    </div>
                    <div id="english-level-grid" class="progress-grid" style="grid-template-columns: repeat(5, 1fr);"></div>
                    <div class="text-left text-xs text-gray-400 mt-2">*상위권: 동학년 목표달성장학생 레벨 분포</div>
                    <div class="bg-purple-50 border border-purple-200 rounded-lg p-6 mt-6">
                        <h4 class="font-bold text-lg text-purple-800">💡 특목/자사고 합격자의 영어 학습 TIP</h4>
                        <p class="mt-3 text-sm text-purple-700">
                            <strong>특목/자사고 합격생들은 영어의 기본기를 탄탄하게 다지는 것을 가장 중요하게 생각합니다.</strong> 특히, 꾸준한 단어 암기와 문법 학습을 통해 독해의 정확성을 높이는 데 집중하는 경향을 보입니다.<br><br>
                            또한, 현재 레벨에 만족하지 않고 <strong>한 단계 높은 수준의 지문을 미리 접하며 문제 해결 능력을 키우는 것</strong>도 상위권 학생들의 공통된 학습 패턴입니다.<br><br>
                            미소 학생도 현재 학습에 더해, 매일 10개씩 새로운 단어를 암기하고, 주 1회 심화 독해 문제에 도전해보는 것은 어떨까요? 작은 습관이 큰 실력 차이를 만들 수 있습니다. 🚀
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- D-Day Section -->
        <section class="section-card p-4">
            <div class="flex flex-col sm:flex-row items-center text-center sm:text-left">
                <div class="flex-shrink-0 mb-3 sm:mb-0 sm:mr-4">
                    <span class="text-red-600 font-bold text-2xl">D-13</span>
                </div>
                <div class="flex-grow">
                    <p class="text-gray-700 text-sm md:text-base leading-relaxed">
                        <strong>장평중학교의 2학기 개학일</strong>이 얼마 남지 않았습니다. 미소 학생이 <strong>2학기를 힘차게 시작할 수 있도록 응원과 격려를 보내주세요.</strong> 선선한 바람이 불어올 다음 달, 미소 학생의 또 다른 성장 이야기로 찾아뵙겠습니다.<br>
                    </p>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer Section -->
    <footer class="text-center py-8 mt-4 text-sm text-gray-500 border-t border-gray-200">
        <div class="mb-6">
            <a href="https://yoongu-kang.github.io/mgreport-sample/" target="_blank" class="inline-block bg-gray-200 text-gray-700 font-semibold py-2 px-5 rounded-lg hover:bg-gray-300 transition-colors">
                다른 샘플 리포트 보러가기
            </a>
        </div>
        <p>&copy; 2025 Mbest. All Rights Reserved.</p>
    </footer>


    <script>
        document.addEventListener('DOMContentLoaded', function () {
            
            // --- START: 공통 함수 및 데이터 ---
            const bgClasses = ['bg-blue-500', 'text-white', 'bg-blue-400', 'bg-blue-300', 'bg-blue-200', 'bg-blue-100', 'bg-gray-100'];

            function getBgColor(percentage) {
                if (percentage > 80) return 'bg-blue-500 text-white';
                if (percentage > 50) return 'bg-blue-400 text-white';
                if (percentage > 30) return 'bg-blue-300';
                if (percentage > 10) return 'bg-blue-200';
                if (percentage > 0) return 'bg-blue-100';
                return 'bg-gray-100';
            }
            // --- END: 공통 함수 및 데이터 ---

            // --- START: 워드 클라우드 생성 (반응형 및 시각 효과 개선) ---
            
            /**
             * Debounce function to limit the rate at which a function gets called.
             * @param {Function} func The function to debounce.
             * @param {number} wait The delay in milliseconds.
             * @returns {Function} The debounced function.
             */
            function debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }

            function createWordCloud() {
                const container = document.getElementById('word-cloud-container');
                if (!container || container.offsetWidth === 0) return;

                container.innerHTML = ''; 

                // 단어별 가중치를 조정하여 크기 차이를 극대화
                const words = [
                    {text: "복습은 나의 것", size: 70},
                    {text: "열공보상 사냥꾼", size: 65},
                    {text: "집중 파워 업", size: 45},
                    {text: "문제풀이 도전왕", size: 30},

                ];

                const width = container.offsetWidth;
                const height = container.offsetHeight;
                
                const colorScale = d3.scaleOrdinal()
                    .range(["#4f46e5", "#3b82f6", "#10b981", "#f59e0b", "#ef4444", "#8b5cf6"]);

                // 폰트 크기 스케일을 조정하여 더 극적인 차이를 만듦
                const minFontSize = 12;
                const maxFontSize = Math.max(40, width / 10); // 최대 폰트 크기 비율 조정
                const fontSizeScale = d3.scalePow().exponent(2)
                    .domain([d3.min(words, d => d.size), d3.max(words, d => d.size)])
                    .range([minFontSize, maxFontSize]);

                const layout = d3.layout.cloud()
                    .size([width, height])
                    .words(words.map(d => ({text: d.text, size: d.size})))
                    .padding(8)
                    // 모든 단어를 수평으로 표시
                    .rotate(() => 0) 
                    .font("Noto Sans KR")
                    .fontSize(d => fontSizeScale(d.size))
                    .on("end", draw);

                layout.start();

                function draw(words) {
                    d3.select(container).append("svg")
                        .attr("width", layout.size()[0])
                        .attr("height", layout.size()[1])
                        .append("g")
                        .attr("transform", "translate(" + layout.size()[0] / 2 + "," + layout.size()[1] / 2 + ")")
                        .selectAll("text")
                        .data(words)
                        .enter().append("text")
                        .attr("class", "word-cloud-text")
                        .style("font-size", "1px")
                        .style("font-family", "Noto Sans KR")
                        .style("font-weight", "bold")
                        .style("fill", (d, i) => colorScale(i))
                        .attr("text-anchor", "middle")
                        .attr("transform", d => "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")")
                        .text(d => d.text)
                        .transition()
                        .duration(600)
                        .style("font-size", d => d.size + "px");
                }
            }
            
            // 초기 로드 시 워드 클라우드 생성
            createWordCloud();
            // 창 크기 조절 시 디바운스를 적용하여 워드 클라우드 재생성
            window.addEventListener('resize', debounce(createWordCloud, 250));
            // --- END: 워드 클라우드 생성 ---

            // --- START: 토글 버튼 기능 추가 ---
            function setupToggle(buttonId, contentId) {
                const toggleButton = document.getElementById(buttonId);
                const collapsibleContent = document.getElementById(contentId);

                if (toggleButton && collapsibleContent) {
                    toggleButton.addEventListener('click', function() {
                        const isHidden = collapsibleContent.style.display === 'none';
                        collapsibleContent.style.display = isHidden ? 'block' : 'none';
                        this.innerHTML = isHidden ? '숨기기 ▲' : '더 보기 ▼';
                    });
                }
            }
            
            setupToggle('toggle-korean-button', 'collapsible-korean-cards');
            setupToggle('toggle-science-button', 'collapsible-science-cards');
            setupToggle('toggle-english-button', 'collapsible-english-cards');
            // --- END: 토글 버튼 기능 추가 ---

            // --- START: 탭 기능 ---
            const tabs = document.getElementById('subject-tabs');
            const tabContents = {
                math: document.getElementById('math-content'),
                english: document.getElementById('english-content')
            };

            tabs.addEventListener('click', function(e) {
                const button = e.target.closest('button');
                if (!button) return;

                const tab = button.dataset.tab;

                tabs.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');

                Object.values(tabContents).forEach(content => content.classList.remove('active'));

                if (tabContents[tab]) {
                    tabContents[tab].classList.add('active');
                }
            });
            // --- END: 탭 기능 ---


            // --- START: 수학 진도 분포표 ---
            const mathGrid = document.getElementById('math-progress-grid');
            const mathData = {
                topTier: { 
                    '1-1': { '기본': 30, '발전': 6, '심화': 3 }, 
                    '1-2': { '기본': 39, '발전': 5, '심화': 3 }, 
                    '2-1': { '기본': 5, '발전': 1, '심화': 1 }, 
                    '2-2': { '기본': 4, '발전': 3, '심화': 1 } 
                },
                myPosition: { semester: '1-2', level: '기본' },
                topTierPath: [ { semester: '1-2', level: '심화' }, { semester: '2-1', level: '발전' }, { semester: '2-2', level: '기본' } ],
                tooltips: { '1-2': { '기본': "[주요 학습 진도] 삼각형의 성질, 사각형의 성질", '발전': "[주요 학습 진도] 도형의 닮음", '심화': "[주요 학습 진도] 도형의 닮음" }, '2-1': { '기본': "[주요 학습 진도] 제곱근과 실수", '발전': "[주요 학습 진도] 다항식, 방정식", '심화': "[주요 학습 진도] 다항식, 방정식" }, '2-2': { '기본': "[주요 학습 진도] 삼각비", '발전': "[주요 학습 진도] 삼각비" } }
            };

            function createMathGrid() {
                if (!mathGrid) return;
                const semesters = ['중1-1', '중1-2', '중2-1', '중2-2'];
                const levels = ['심화', '발전', '기본'];
                let gridHtml = `<div class="grid-cell grid-header"></div>`;
                semesters.forEach(s => gridHtml += `<div class="grid-cell grid-header">${s}</div>`);
                levels.forEach(level => {
                    gridHtml += `<div class="grid-cell grid-header">${level}</div>`;
                    semesters.forEach(semester => { gridHtml += `<div class="grid-cell" data-semester="${semester.replace('중','')}" data-level="${level}"></div>`; });
                });
                mathGrid.innerHTML = gridHtml;
                renderMathGrid();
            }

            function renderMathGrid() {
                if (!mathGrid) return;
                const data = mathData.topTier;
                const semesters = ['1-1', '1-2', '2-1', '2-2'];
                const levels = ['심화', '발전', '기본'];
                levels.forEach(level => {
                    semesters.forEach(semester => {
                        const cell = mathGrid.querySelector(`[data-semester="${semester}"][data-level="${level}"]`);
                        if (!cell) return;
                        const percentage = data[semester]?.[level] ?? 0;
                        cell.classList.remove(...bgClasses, 'top-tier-path');
                        cell.classList.add(...getBgColor(percentage).split(' '));
                        let cellContent = `<span>${percentage > 0 ? `${percentage}%` : '&nbsp;'}</span>`;
                        let cellTitle = '';
                        // ME 아이콘 표시 로직 삭제
                        if (mathData.tooltips[semester]?.[level]) { 
                            cellTitle = mathData.tooltips[semester][level]; 
                        }
                        if (mathData.topTierPath.some(p => p.semester === semester && p.level === level)) { 
                            cell.classList.add('top-tier-path'); 
                        }
                        cell.innerHTML = cellContent;
                        cell.title = cellTitle;
                    });
                });
            }
            createMathGrid();
            // --- END: 수학 진도 분포표 ---

            // --- START: 영어 레벨 분포표 ---
            const englishGrid = document.getElementById('english-level-grid');
            const englishData = {
                distribution: { 'EB ~ EM': 1, 'EH ~ IB': 16, 'IM ~ IH': 33, 'AB ~ AM': 34, 'AH ~ MA': 16, },
                myPosition: 'IM ~ IH',
                topTierPath: ['AH ~ MA', 'AB ~ AM'],
                tooltips: { 'EB ~ EM': '기초 다지기 단계', 'EH ~ IB': '기본 개념 확장 단계', 'IM ~ IH': '응용 및 심화 시작 단계', 'AB ~ AM': '심화 문제 해결 단계', 'AH ~ MA': '최상위권 수준 완성 단계', }
            };

            function createAndRenderEnglishGrid() {
                if (!englishGrid) return;
                englishGrid.innerHTML = '';
                const levels = ['EB ~ EM', 'EH ~ IB', 'IM ~ IH', 'AB ~ AM', 'AH ~ MA'];
                levels.forEach(level => {
                    const headerCell = document.createElement('div');
                    headerCell.className = 'grid-cell grid-header';
                    headerCell.textContent = level;
                    englishGrid.appendChild(headerCell);
                });
                levels.forEach(level => {
                    const cell = document.createElement('div');
                    cell.className = 'grid-cell h-24';
                    const percentage = englishData.distribution[level] || 0;
                    const bgColorClass = getBgColor(percentage);
                    cell.classList.add(...bgColorClass.split(' '));
                    let contentHtml = `<span class="font-bold text-lg">${percentage}%</span>`;
                    let cellTitle = '';
                    if (englishData.myPosition === level) {
                        contentHtml = `<span class="me-icon">ME</span>` + contentHtml;
                        cellTitle = "[나의 레벨] 현재 이 레벨에서 학습하고 있습니다.";
                    }
                    if (englishData.tooltips[level]) { cellTitle = (cellTitle ? cellTitle + '\n' : '') + englishData.tooltips[level]; }
                    if (englishData.topTierPath.includes(level)) { cell.classList.add('top-tier-path'); }
                    cell.innerHTML = contentHtml;
                    cell.title = cellTitle;
                    englishGrid.appendChild(cell);
                });
            }
            createAndRenderEnglishGrid();
            // --- END: 영어 레벨 분포표 ---
        });
    </script>
</body>
</html>
