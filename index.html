<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <!-- 모바일 기기에서 올바른 화면 비율을 위한 뷰포트 설정 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI 학습 분석 리포트 - 손건우 학생</title>

    <!-- Tailwind CSS CDN 로드 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js CDN 로드 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Google Fonts (Inter, Noto Sans KR) 로드 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* 기본 바디 스타일 및 폰트 설정 */
        body {
            font-family: 'Noto Sans KR', 'Inter', sans-serif;
            background-color: #f9fafb; /* 부드러운 회색 배경 */
            color: #1f2937; /* 가독성 높은 텍스트 색상 */
            -webkit-font-smoothing: antialiased; /* 폰트 렌더링 최적화 */
            -moz-osx-font-smoothing: grayscale;
        }
        /* 섹션 카드 공통 스타일: 반복되는 Tailwind 클래스를 묶어 코드 간소화 및 유지보수성 향상 */
        .section-card {
            background-color: white;
            border-radius: 0.75rem; /* 12px */
            padding: 1.5rem; /* 24px */
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
            margin-bottom: 1.5rem; /* 24px */
        }

        /* 인쇄 시 스타일 조정 */
        @media print {
            body {
                background-color: #ffffff; /* 인쇄 시 배경색 제거 */
                color: #000000; /* 인쇄 시 텍스트 색상을 검정으로 */
                -webkit-print-color-adjust: exact; /* 배경색 및 이미지 인쇄 강제 */
                print-color-adjust: exact;
            }
            .section-card {
                box-shadow: none; /* 인쇄 시 그림자 제거 */
                border: 1px solid #e5e7eb; /* 인쇄 시 테두리 추가 */
                margin-bottom: 1rem; /* 인쇄 시 마진 조정 */
                padding: 1rem; /* 인쇄 시 패딩 조정 */
            }
            /* 차트 컨테이너의 높이를 고정하여 겹침 방지 */
            .chart-container {
                height: 300px !important; /* 인쇄 시 차트 높이 고정 */
                max-height: 300px !important; /* 최대 높이도 고정 */
                width: 100% !important; /* 너비는 100% 유지 */
            }
            /* 차트 아래 텍스트 박스의 마진 조정 */
            .chart-info-box {
                margin-top: 1.5rem !important; /* 차트와 겹치지 않도록 위쪽 마진 추가 */
            }
            /* 불필요한 요소 숨기기 (예: 푸터) */
            footer {
                display: none;
            }
        }
        /* 태그 스타일 */
        .tag {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 600;
        }
        /* 진도 분석 그리드 스타일 */
        
        .progress-grid {
            display: grid;
            grid-template-columns: 80px repeat(4, 1fr); /* 첫 번째 컬럼은 헤더, 나머지 4개는 학기 */
            gap: 0.5rem; /* 그리드 셀 간 간격 */
            text-align: center;
            font-size: 0.875rem; /* 14px */
            color: #374151; /* gray-700 */
        }
        .grid-cell {
            background-color: #f3f4f6; /* gray-100 */
            border-radius: 0.5rem; /* 8px */
            padding: 0.75rem 0.5rem; /* 12px 8px */
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 500;
            position: relative; /* ME 아이콘 위치 지정을 위해 */
            transition: background-color 0.3s ease; /* 배경색 변화 애니메이션 */
        }
        .grid-header {
            background-color: #e5e7eb; /* gray-200 */
            font-weight: 700;
            color: #1f2937; /* gray-900 */
        }
        /* 나의 진도 표시 */
        .me-icon {
            position: absolute;
            top: 0.25rem;
            left: 0.25rem;
            background-color: #ef4444; /* red-500 */
            color: white;
            font-size: 0.625rem; /* 10px */
            font-weight: 700;
            padding: 0.1rem 0.3rem;
            border-radius: 0.375rem; /* 6px */
        }
        /* 상위권 경로 표시 */
        .top-tier-path {
            border: 2px solid #facc15; /* yellow-400 */
            box-shadow: 0 0 0 2px rgba(250, 204, 21, 0.5); /* 강조 효과 */
        }
        /* 탭 버튼 스타일 */
        .tab-button {
            padding: 0.75rem 1.5rem;
            border-bottom: 3px solid transparent;
            font-weight: 600;
            color: #6b7280;
        }
        .tab-button.active {
            border-color: #4f46e5;
            color: #4f46e5;
        }
                /* 토글 버튼 스타일 */
        .toggle-btn {
            background-color: transparent;
            color: #6b7280; /* gray-500 */
            font-weight: 500;
            transition: all 0.2s ease-in-out;
        }
        .toggle-btn.active {
            background-color: #ffffff;
            color: #4f46e5; /* indigo-600 */
            box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        }
        /* 탭 버튼 스타일 */
        .tab-button {
            padding: 0.75rem 1.5rem;
            border-bottom: 3px solid transparent;
            font-weight: 600;
            color: #6b7280;
            transition: all 0.2s ease-in-out;
        }
        .tab-button.active {
            border-color: #4f46e5;
            color: #4f46e5;
        }
    </style>
</head>
<body>

    <main class="max-w-3xl mx-auto p-4 md:p-6">
        <!-- Report Title and Period Section -->
        <div class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800">손건우 학생 월간 리포트</h1>
            <p class="text-md md:text-lg text-gray-500 mt-2">2025년 7월 학습 분석</p>
            <div class="mt-3 text-sm text-gray-400">
                <p>분석 기간: 2025년 7월 1일 ~ 7월 31일</p>
            </div>
        </div>

        <!-- D-Day 섹션 (반응형 수정) -->
        <section class="section-card p-4">
                <div class="flex-grow mb-4">
                    <p class="text-gray-700 text-sm md:text-base leading-relaxed">
                        뜨거운 여름 햇살 아래, 한 학기를 성실히 마무리한 아이의 모습이 더욱 반짝입니다. <strong>7월, 그동안의 여정을 되돌아보며 건우 학생을 향한 격려와 응원을 담아보았습니다.</strong><br>
                    </p>
                </div>
            <div class="flex flex-col sm:flex-row items-center text-center sm:text-left">
                <div class="flex-shrink-0 mb-3 sm:mb-0 sm:mr-4">
                    <span class="text-red-600 font-bold text-2xl">D-13</span>
                </div>
                <div class="flex-grow">
                    <p class="text-gray-700 text-sm md:text-base leading-relaxed">
                        <strong>장평중학교의 2학기 개학일</strong>이 얼마 남지 않았습니다. 리포트에서 건우 학생이 지난 한 달 <strong>2학기를 위해 준비한 것</strong>이 무엇인지 확인하실 수 있습니다.<br>
                    </p>
                </div>
            </div>
        </section>
        
        
        <!-- 1. Overall Summary -->
        <section class="section-card">
            <h2 class="text-xl font-bold mb-3 text-indigo-600">🚀 7월의 성장</h2>
            <p class="text-gray-600 mb-4">
                6월에 비해 <strong class="text-gray-800">스스로 세운 수강 계획의 출석률이 25% 늘어, 학습 태도가 더욱 성실해졌습니다.</strong><br><br>
                또한 <strong class="text-gray-800">과학 과목에서 질문/답변 게시판을 통해 4회 이상 선생님께 질문하는 등 호기심을 바탕으로 탐구하는 자세가 훌륭합니다.</strong><br><br>
                건우 학생에게 많은 칭찬과 응원을 보내주세요. 💪
            </p>
            <div class="flex justify-around text-center text-sm">
                <div>
                    <p class="font-bold text-2xl text-indigo-500">22<span class="text-lg">일</span></p>
                    <p class="text-gray-500">계획 출석</p>
                </div>
                <div>
                    <p class="font-bold text-2xl text-indigo-500">4<span class="text-lg">회</span></p>
                    <p class="text-gray-500">강좌 Q&A</p>
                </div>
            </div>
        </section>

        <!-- 2. Detailed Analysis by Subject -->
        <h2 class="text-2xl font-bold mb-4 mt-10 text-center text-gray-800">과목별 학습 상세</h2>

        <!-- Subject analysis cards... -->
        <div class="section-card">
            <h3 class="text-xl font-bold text-gray-800 mb-3">📖 국어</h3>
            <div class="space-y-4">
                <div>
                    <p class="text-sm text-gray-600 mt-1">1단원에서 <strong class="text-red-500">‘멍키 스패너’</strong> 문학 작품을 통해 <strong>등장인물의 내적/외적 갈등</strong>에 대해 배웠습니다.</p>
                </div>
                <div>
                    <p class="text-sm text-gray-600 mt-1">소설 작품의 내용뿐만 아니라 <strong class="text-blue-600">서술자 관점과 시점의 종류(1인칭, 3인칭)와 1인칭 화자의 한계점</strong>은
                    건우 학생의 또래 친구들이 <strong>가장 어려워하는 핵심 개념</strong>입니다. </p>
                </div>
            </div>
        </div>
        <div class="section-card">
            <h3 class="text-xl font-bold text-gray-800 mb-3">🔬 과학</h3>
            <div class="space-y-4">
                <div>
                    <p class="text-sm text-gray-600 mt-1"><strong class="text-red-500">‘여러 가지 힘’</strong> 단원을 중심으로 수강했습니다.<br>
                        <strong>핵심키워드 평가</strong>를 통해 수강 후 배운 개념을 복습하고 있는 것을 칭찬합니다. 👍</p>
                </div>
                <div>
                    <p class="text-sm text-gray-600 mt-1">‘여러 가지 힘’ 단원에서 <strong class="text-blue-600">힘의 정의와 3요소 (크기 · 방향 · 작용점)</strong> 및 힘의 벡터적 성질은
                        해당 단원에서 <strong>반드시 알아야 하는 핵심 개념</strong>입니다.</p>
                </div>
            </div>
        </div>

        <!-- Math Cards Container -->
        <div class="math-cards-container">
            <!-- First Math Card (Always Visible) -->
            <div class="section-card">
                <h3 class="text-xl font-bold text-gray-800 mb-3">🧮 수학</h3>
                <div class="space-y-4">
                    <div>
                        <p class="text-sm text-gray-600 mt-1">
                            1학년 2학기의 <strong class="text-red-500">‘기본 도형’,  ‘평면도형’</strong> 단원을 중점으로 수강했습니다.<br>
                            1학년 2학기의 심화 강좌, 2학년 1학기의 기본 강좌를 추가적으로 수강하며 <strong class="text-blue-600">적극적으로 수학을 공부</strong>하고 있습니다.
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-600 mt-1">
                            건우 학생이 공부한 단원에서 <strong class="text-blue-600">점 · 선 · 면과 각의 종류(예각, 직각, ,둔각, 보각), 평행선과 각의 성질(동위각, 엇각, 맞꼭지각 및 평행선 판정)</strong>은
                            해당 단원에서 <strong>반드시 알아야 하는 핵심 개념</strong>입니다.</p>
                    </div>
                </div>
            </div>

            <!-- Collapsible Section for other math cards -->
            <div id="collapsible-math-cards" style="display: none;">
                <div class="section-card">
                    <h3 class="text-xl font-bold text-gray-800 mb-3">🧮 수학</h3>
                    <div class="space-y-4">
                        <div>
                            <p class="text-sm text-gray-600 mt-1">
                                2학년 2학기의 <strong class="text-red-500">‘기본 도형’,  ‘평면도형’</strong> 단원을 중점으로 수강했습니다.<br>
                                1학년 2학기의 심화 강좌, 2학년 1학기의 기본 강좌를 추가적으로 수강하며 <strong class="text-blue-600">적극적으로 수학을 공부</strong>하고 있습니다.
                            </p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-600 mt-1">
                                건우 학생이 공부한 단원에서 <strong class="text-blue-600">점 · 선 · 면과 각의 종류(예각, 직각, ,둔각, 보각), 평행선과 각의 성질(동위각, 엇각, 맞꼭지각 및 평행선 판정)</strong>은
                                해당 단원에서 <strong>반드시 알아야 하는 핵심 개념</strong>입니다.</p>
                        </div>
                    </div>
                </div>
                <div class="section-card">
                    <h3 class="text-xl font-bold text-gray-800 mb-3">🧮 수학</h3>
                    <div class="space-y-4">
                        <div>
                            <p class="text-sm text-gray-600 mt-1">
                                2학년 2학기의 <strong class="text-red-500">‘기본 도형’,  ‘평면도형’</strong> 단원을 중점으로 수강했습니다.<br>
                                1학년 2학기의 심화 강좌, 2학년 1학기의 기본 강좌를 추가적으로 수강하며 <strong class="text-blue-600">적극적으로 수학을 공부</strong>하고 있습니다.
                            </p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-600 mt-1">
                                건우 학생이 공부한 단원에서 <strong class="text-blue-600">점 · 선 · 면과 각의 종류(예각, 직각, ,둔각, 보각), 평행선과 각의 성질(동위각, 엇각, 맞꼭지각 및 평행선 판정)</strong>은
                                해당 단원에서 <strong>반드시 알아야 하는 핵심 개념</strong>입니다.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Toggle Button -->
        <div class="flex justify-center -mt-4 mb-4">
            <button id="toggle-math-button" class="text-indigo-600 hover:text-indigo-800 font-semibold text-sm py-2 px-4">
                더 보기 ▼
            </button>
        </div>

        <div class="section-card">
            <h3 class="text-xl font-bold text-gray-800 mb-3">🔤 영어</h3>
            <div class="space-y-4">
                <div>
                    <p class="text-sm text-gray-600 mt-1">5단원의 <strong class="text-red-500">‘영단어, 대화 표현, 영문법, 본문 독해’</strong>에 대해 배웠습니다.</p>
                </div>
                <div>
                    <p class="text-sm text-gray-600 mt-1">건우 학생이 공부한 단원에서 <strong class="text-blue-600">There is/are 구문 + 장소 · 수량 표현의 '어순, 단수 · 복수 주어 일치' 문제</strong>
                        는 시험에 자주 나오는 <strong>출제 포인트</strong>입니다.</p>
                </div>
            </div>
        </div>
        <div class="section-card">
            <h3 class="text-xl font-bold text-gray-800 mb-3">📜 사회</h3>
            <div class="space-y-4">
                <div>
                    <p class="text-sm text-gray-600 mt-1"><strong class="text-red-500">‘사회화와 자아 정체성’</strong>단원의 <strong>대단원 성취도 평가</strong>를 통해 단원의 전반에 대한 자신의 이해도를 점검했습니다.</p>
                </div>
                <div>
                    <p class="text-sm text-gray-600 mt-1"><strong class="text-blue-600">자아 정체의 형성 요인 (개인 · 사회 · 문화적 요인의 상호작용과 청소년기 특징)</strong>은
                        건우 학생의 또래 친구들이 <strong>가장 어려워하는 핵심 개념</strong>입니다. </p>
                    </p>
                </div>
            </div>
        </div>

        <!-- 3. 시기별 교육 정보 -->
        <h2 class="text-2xl font-bold mb-4 mt-10 text-center text-gray-800">시기별 교육 정보</h2>
        <div class="section-card">
            <div id="tab-progress-math-content">
                    <div class="bg-purple-50 border border-purple-200 rounded-lg p-6 flex flex-col">
                        <h4 class="font-bold text-lg text-purple-800">💡 첫 시험 대비는 엠베스트와 함께 </h4>
                        <div class="flex-grow">
                            <p class="mt-3 text-sm text-purple-700">
                                1학기 자유학기제를 마무리한 중학교 1학년 학생들은, 2학기부터 <strong>처음으로 중간고사와 기말고사</strong>를 경험하게 됩니다.
                                첫 시험인 만큼, <strong>시험에 대한 압박과 불안</strong>을 느끼는 학생들이 많을 수 있는데요.
                                <strong>지금 이 여름방학 기간을 활용해, 시험 대비를 위한 기본적인 학습 습관을 미리 형성해두는 것이 중요합니다.</strong><br><br>
                                아직은 <strong>자신만의 공부 방법이나 시간 관리가 완성되지 않았을 시기</strong>이기 때문에,
                                2학기를 준비하며 예습과 함께 <strong>효과적인 시험 공부법을 터득하는 과정</strong>이 꼭 필요합니다.<br><br>
                                엠베스트 프라임 탭에서만 볼 수 있는《서울대 비밀과외 (수행평가+)》를 통해,
                                우리 아이가 <strong>스스로에게 맞는 학습법을 찾아갈 수 있도록 응원해 주세요.</strong>
                                처음 겪는 시험이 두렵지 않도록, 지금의 작은 준비가 아이에게 <strong>큰 자신감</strong>이 되어줄 수 있습니다. 😊
                            </p>
                        </div>
                    </div>
            </div>
        </div>


        
        <!-- 3. Learning Path Recommendation -->
        <h2 class="text-2xl font-bold mb-4 mt-10 text-center text-gray-800">학습 방향 추천</h2>

        
        <div class="section-card">
            <!-- Tab Buttons -->
            <div class="flex justify-center border-b border-gray-200 mb-6">
                <button class="tab-button active">엠베스트 회원의 수학 진도 분포</button>
            </div>

            <!-- Math Progress Analysis Content -->
            <div>
                <!-- Legend -->
                <div class="flex flex-wrap justify-between items-center mb-4 gap-4">
                    <div class="flex items-center flex-wrap gap-x-4 gap-y-2 text-sm">
                        <div class="flex items-center"><span class="w-4 h-4 rounded-full bg-red-500 mr-2 flex-shrink-0"></span><span>나의 진도</span></div>
                        <div class="flex items-center"><span class="w-4 h-4 rounded-sm bg-blue-200 mr-2 flex-shrink-0"></span><span>동학년 분포</span></div>
                        <div class="flex items-center"><span class="w-4 h-4 rounded-sm border-2 border-yellow-500 mr-2 flex-shrink-0"></span><span>상위권 최다 수강</span></div>
                    </div>
                </div>

                <!-- Math Progress Grid (Content generated by JavaScript) -->
                <div id="math-progress-grid" class="progress-grid">
                    <!-- Grid content will be generated by JavaScript -->
                </div>
                <div class="text-left text-xs text-gray-400 mt-2">
                    *상위권 학생: 동학년 목표달성장학생의 수강
                </div>

                <!-- AI Recommendation for Math -->
                <div class="bg-purple-50 border border-purple-200 rounded-lg p-6 mt-6">
                    <h4 class="font-bold text-lg text-purple-800">💡 특목/자사고 합격자의 수학 학습 TIP</h4>
                    <p class="mt-3 text-sm text-purple-700">
                        <strong>특목/자사고에 합격한 엠베스트 회원들의 수학 학습 패턴을 분석한 결과, 현재 진도를 심화 강좌로 복습</strong>하는 경우가 대다수였고,
                        <strong>심화 강좌를 개념 강좌와 동시에 학습</strong>하는 경우도 많았습니다.<br><br>

                        또한 <strong>학기별 연계성이 강한 수학 특성상, 다음 학년의 내용을 미리 공부</strong>하는 비중도 높았습니다. (예시: 2학년 2학기와 3학년 2학기 학습 병행)<br><br>
                        
                        건우 학생의 수학 실력을 더욱 탄탄히 다지기 위해 필요한 강좌 혹은 추가 학습에 대해 함께 이야기 나누어 보시면 좋을 것 같습니다. 😎
                    </p>
                </div>
            </div>
        </div>

        <!-- English Level Distribution -->
        <div class="section-card">
            <!-- Tab Button -->
            <div class="flex justify-center border-b border-gray-200 mb-6">
                <button class="tab-button active">엠베스트 회원의 영어 레벨 분포</button>
            </div>

            <!-- Content -->
            <div>
                <!-- Legend -->
                <div class="flex flex-wrap justify-between items-center mb-4 gap-4">
                    <div class="flex items-center flex-wrap gap-x-4 gap-y-2 text-sm">
                        <div class="flex items-center"><span class="w-4 h-4 rounded-full bg-red-500 mr-2 flex-shrink-0"></span><span>나의 레벨</span></div>
                        <div class="flex items-center"><span class="w-4 h-4 rounded-sm bg-blue-200 mr-2 flex-shrink-0"></span><span>동학년 레벨</span></div>
                        <div class="flex items-center"><span class="w-4 h-4 rounded-sm border-2 border-yellow-500 mr-2 flex-shrink-0"></span><span>상위권 레벨</span></div>
                    </div>
                </div>

                <!-- English Level Grid -->
                <div id="english-level-grid" class="progress-grid" style="grid-template-columns: repeat(5, 1fr); gap: 0.5rem;">
                    <!-- Grid content will be generated by JavaScript -->
                </div>
                <div class="text-left text-xs text-gray-400 mt-2">
                    *상위권 학생: 동학년 목표달성장학생의 수강
                </div>

                <!-- AI Recommendation for English -->
                <div class="bg-purple-50 border border-purple-200 rounded-lg p-6 mt-6">
                    <h4 class="font-bold text-lg text-purple-800">💡 특목/자사고 합격자의 영어 학습 TIP</h4>
                    <p class="mt-3 text-sm text-purple-700">
                        <strong>특목/자사고 합격생들은 영어의 기본기를 탄탄하게 다지는 것을 가장 중요하게 생각합니다.</strong> 특히, 꾸준한 단어 암기와 문법 학습을 통해 독해의 정확성을 높이는 데 집중하는 경향을 보입니다.<br><br>
                        또한, 현재 레벨에 만족하지 않고 <strong>한 단계 높은 수준의 지문을 미리 접하며 문제 해결 능력을 키우는 것</strong>도 상위권 학생들의 공통된 학습 패턴입니다.<br><br>
                        건우 학생도 현재 학습에 더해, 매일 10개씩 새로운 단어를 암기하고, 주 1회 심화 독해 문제에 도전해보는 것은 어떨까요? 작은 습관이 큰 실력 차이를 만들 수 있습니다. 🚀
                    </p>
                </div>
            </div>
        </div>

    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            
            // --- START: 토글 버튼 기능 추가 ---
            const toggleButton = document.getElementById('toggle-math-button');
            const collapsibleContent = document.getElementById('collapsible-math-cards');

            if (toggleButton && collapsibleContent) {
                toggleButton.addEventListener('click', function() {
                    // 현재 숨겨져 있는지 확인
                    const isHidden = collapsibleContent.style.display === 'none';
                    
                    if (isHidden) {
                        // 숨겨져 있다면 보이게 하고 버튼 텍스트 변경
                        collapsibleContent.style.display = 'block';
                        this.innerHTML = '숨기기 ▲';
                    } else {
                        // 보이고 있다면 숨기고 버튼 텍스트 변경
                        collapsibleContent.style.display = 'none';
                        this.innerHTML = '더 보기 ▼';
                    }
                });
            }
            // --- END: 토글 버튼 기능 추가 ---


            const mathGrid = document.getElementById('math-progress-grid');
            
            // Math progress data definition
            const mathData = {
                topTier: { // 상위권 학생 진도 분포
                    '2-1': { '기본': 0, '발전': 6, '심화': 0 },
                    '2-2': { '기본': 36, '발전': 9, '심화': 21 },
                    '3-1': { '기본': 8, '발전': 6, '심화': 3 },
                    '3-2': { '기본': 6, '발전': 5, '심화': 0 },
                },
                myPosition: { semester: '2-2', level: '기본' }, // 나의 현재 진도
                topTierPath: [ // 상위권을 위한 추천 학습 경로
                    { semester: '2-2', level: '심화' },
                    { semester: '3-1', level: '발전' },
                ],
                tooltips: { // 각 셀에 대한 툴팁 메시지
                    '2-2': {
                        '기본': "[주요 학습 진도] 삼각형의 성질, 사각형의 성질",
                        '발전': "[주요 학습 진도] 도형의 닮음",
                        '심화': "[주요 학습 진도] 도형의 닮음"
                    },
                    '3-1': {
                        '기본': "[주요 학습 진도] 제곱근과 실수",
                        '발전': "[주요 학습 진도] 다항식, 방정식",
                        '심화': "[주요 학습 진도] 다항식, 방정식"
                    },
                    '3-2': {
                        '기본': "[주요 학습 진도] 삼각비",
                        '발전': "[주요 학습 진도] 삼각비"
                    }
                }
            };

            const bgClasses = ['bg-blue-500', 'text-white', 'bg-blue-400', 'bg-blue-300', 'bg-blue-200', 'bg-blue-100', 'bg-gray-100'];

            function getBgColor(percentage) {
                if (percentage > 80) return 'bg-blue-500 text-white';
                if (percentage > 50) return 'bg-blue-400 text-white';
                if (percentage > 30) return 'bg-blue-300';
                if (percentage > 10) return 'bg-blue-200';
                if (percentage > 0) return 'bg-blue-100';
                return 'bg-gray-100';
            }

            function renderMathGrid() {
                const data = mathData.topTier;

                ['2-1', '2-2', '3-1', '3-2'].forEach(semester => {
                    ['기본', '발전', '심화'].forEach(level => {
                        const cell = mathGrid.querySelector(`[data-semester="${semester}"][data-level="${level}"]`);
                        if (!cell) return;

                        const percentage = data[semester]?.[level] ?? 0;
                        
                        cell.classList.remove(...bgClasses, 'top-tier-path');
                        cell.classList.add(...getBgColor(percentage).split(' '));
                        cell.title = '';
                        
                        if (mathData.myPosition.semester === semester && mathData.myPosition.level === level) {
                            cell.innerHTML = `<span class="me-icon">ME</span><span>${percentage}%</span>`;
                            cell.title = "[나의 진도] 현재 이 위치에서 학습하고 있습니다.";
                        } else {
                            cell.innerHTML = `<span>${percentage > 0 ? `${percentage}%` : '&nbsp;'}</span>`;
                        }
                        
                        if (mathData.tooltips[semester]?.[level]) {
                            cell.title = (cell.title) 
                                ? `${mathData.tooltips[semester][level]}\n${cell.title}`
                                : mathData.tooltips[semester][level];
                        }
                        
                        if (mathData.topTierPath.some(p => p.semester === semester && p.level === level)) {
                            cell.classList.add('top-tier-path');
                        }
                    });
                });
            }

            function createInitialGrid() {
                const semesters = ['중2-1', '중2-2', '중3-1', '중3-2'];
                const levels = ['심화', '발전', '기본'];
                
                let gridHtml = `<div class="grid-cell grid-header"></div>`;
                semesters.forEach(s => gridHtml += `<div class="grid-cell grid-header">${s}</div>`);

                levels.forEach(level => {
                    gridHtml += `<div style="display: contents;">`;
                    gridHtml += `<div class="grid-cell grid-header" data-level="${level}">${level}</div>`;
                    ['2-1', '2-2', '3-1', '3-2'].forEach(semester => {
                        gridHtml += `<div class="grid-cell" data-semester="${semester}" data-level="${level}"></div>`;
                    });
                    gridHtml += `</div>`;
                });

                mathGrid.innerHTML = gridHtml;
            }

            if (mathGrid) {
                createInitialGrid();
                renderMathGrid();
            }

            // --- START: English Level Grid ---
            const englishGrid = document.getElementById('english-level-grid');

            const englishData = {
                distribution: {
                    'EB ~ EM': 1,
                    'EH ~ IB': 16,
                    'IM ~ IH': 33,
                    'AB ~ AM': 34,
                    'AH ~ MA': 16,
                },
                myPosition: 'IM ~ IH',
                topTierPath: ['AH ~ MA'],
                tooltips: {
                    'EB ~ EM': '기초 다지기 단계',
                    'EH ~ IB': '기본 개념 확장 단계',
                    'IM ~ IH': '응용 및 심화 시작 단계',
                    'AB ~ AM': '심화 문제 해결 단계',
                    'AH ~ MA': '최상위권 수준 완성 단계',
                }
            };

            function createAndRenderEnglishGrid() {
                if (!englishGrid) return;
                englishGrid.innerHTML = ''; // Clear previous content

                const levels = ['EB ~ EM', 'EH ~ IB', 'IM ~ IH', 'AB ~ AM', 'AH ~ MA'];

                levels.forEach(level => {
                    const cell = document.createElement('div');
                    // flex-col과 h-24 클래스를 추가하여 세로 정렬 및 높이 조절
                    cell.className = 'grid-cell flex-col h-24'; 

                    const percentage = englishData.distribution[level] || 0;
                    
                    // 분포도에 따라 배경색 적용
                    const bgColorClass = getBgColor(percentage);
                    cell.classList.add(...bgColorClass.split(' '));

                    // 셀 내용 설정
                    let contentHtml = `<span class="font-bold text-lg">${percentage}%</span><span class="text-xs mt-1">${level}</span>`;

                    // 'ME' 아이콘 추가
                    if (englishData.myPosition === level) {
                        contentHtml = `<span class="me-icon">ME</span>` + contentHtml;
                        cell.title = "[나의 진도] 현재 이 위치에서 학습하고 있습니다.";
                    }

                    // 툴팁 추가
                    if (englishData.tooltips[level]) {
                        cell.title = (cell.title ? cell.title + '\n' : '') + englishData.tooltips[level];
                    }

                    // 상위권 경로 하이라이트
                    if (englishData.topTierPath.includes(level)) {
                        cell.classList.add('top-tier-path');
                    }

                    cell.innerHTML = contentHtml;
                    englishGrid.appendChild(cell);
                });
            }

            if (englishGrid) {
                createAndRenderEnglishGrid();
            }
            // --- END: English Level Grid ---
        });
    </script>
</body>
</html>
