<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI 학습 분석 리포트 - 이미소 학생</title>
    <!-- Tailwind CSS CDN 로드 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js CDN 로드 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Fonts (Inter, Noto Sans KR) 로드 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* 기본 바디 스타일 및 폰트 설정 */
        body {
            font-family: 'Noto Sans KR', 'Inter', sans-serif;
            background-color: #f9fafb; /* 더 부드러운 배경색 */
            color: #1f2937; /* 더 높은 명암비의 텍스트 색상 */
        }
        /* 섹션 카드 공통 스타일 */
        .section-card {
            background-color: white;
            border-radius: 0.75rem; /* 12px */
            padding: 1.5rem; /* 24px */
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
            margin-bottom: 1.5rem; /* 24px */
        }
        /* 태그 스타일 */
        .tag {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 600;
        }
        /* 진도 분석 그리드 스타일 */
        .progress-grid {
            display: grid;
            grid-template-columns: 80px repeat(4, 1fr); /* 첫 번째 컬럼은 헤더, 나머지 4개는 학기 */
            gap: 0.5rem; /* 그리드 셀 간 간격 */
            text-align: center;
            font-size: 0.875rem; /* 14px */
            color: #374151; /* gray-700 */
        }
        .grid-cell {
            background-color: #f3f4f6; /* gray-100 */
            border-radius: 0.5rem; /* 8px */
            padding: 0.75rem 0.5rem; /* 12px 8px */
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 500;
            position: relative; /* ME 아이콘 위치 지정을 위해 */
            transition: background-color 0.3s ease; /* 배경색 변화 애니메이션 */
        }
        .grid-header {
            background-color: #e5e7eb; /* gray-200 */
            font-weight: 700;
            color: #1f2937; /* gray-900 */
        }
        /* 나의 진도 표시 */
        .me-icon {
            position: absolute;
            top: 0.25rem;
            left: 0.25rem;
            background-color: #ef4444; /* red-500 */
            color: white;
            font-size: 0.625rem; /* 10px */
            font-weight: 700;
            padding: 0.1rem 0.3rem;
            border-radius: 0.375rem; /* 6px */
        }
        /* 상위권 경로 표시 */
        .top-tier-path {
            border: 2px solid #facc15; /* yellow-400 */
            box-shadow: 0 0 0 2px rgba(250, 204, 21, 0.5); /* 강조 효과 */
        }
        /* 토글 버튼 스타일 */
        .toggle-btn {
            background-color: transparent;
            color: #6b7280; /* gray-500 */
            font-weight: 500;
            transition: all 0.2s ease-in-out;
        }
        .toggle-btn.active {
            background-color: #ffffff;
            color: #4f46e5; /* indigo-600 */
            box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        }
        /* 탭 버튼 스타일 */
        .tab-button {
            padding: 0.75rem 1.5rem;
            border-bottom: 3px solid transparent;
            font-weight: 600;
            color: #6b7280;
            transition: all 0.2s ease-in-out;
        }
        .tab-button.active {
            border-color: #4f46e5;
            color: #4f46e5;
        }
    </style>
</head>
<body class="antialiased">

    <main class="max-w-3xl mx-auto p-4 md:p-6">
        <!-- 리포트 제목 및 기간 섹션 -->
        <div class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800">이미소 학생 월간 리포트</h1>
            <p class="text-md md:text-lg text-gray-500 mt-2">2025년 7월 학습 분석</p>
            <div class="mt-3 text-sm text-gray-400">
                <p>분석 기간: 2025년 7월 1일 ~ 7월 31일</p>
            </div>
        </div>

        <!-- D-Day 섹션 추가 (반응형 개선) -->
        <section class="section-card bg-white p-4 rounded-lg mb-6 flex flex-col sm:flex-row items-center sm:items-start justify-between text-center sm:text-left">
            <div class="flex items-center mb-3 sm:mb-0 sm:mr-4">
                <span class="text-red-600 font-bold text-3xl sm:text-2xl mr-2 sm:mr-4 flex-shrink-0">D-61</span>
                <p class="text-gray-700 text-sm md:text-base flex-grow">
                    연희중학교의 2학년 2학기 중간고사는 <strong class="text-gray-900 whitespace-nowrap">10월 20일 ~ 10월 21일</strong>입니다.<br class="sm:hidden">
                    아직 시간이 남았지만 <strong class="text-gray-900 whitespace-nowrap">10월에는 긴 연휴가 있기 때문에 8~9월에 학습을 지속</strong>하는 것이 매우 중요해요.
                </p>
            </div>
        </section>
        
        <!-- 1. 종합 요약 -->
        <section class="section-card">
            <h2 class="text-xl font-bold mb-3 text-indigo-600">🚀 7월 학습 요약</h2>
            <p class="text-gray-600 mb-4">
                지난 한 달간 미소 학생은 <strong class="text-indigo-600">국어, 영어, 수학, 과학, 역사 전과목</strong>을 성실하게 학습했습니다. 
                계속해서 과목의 치우침이 없이 <strong class="text-gray-800">골고루 학습한다면 미래를 위한 공부 체력이 쑥쑥 클 거예요</strong> 💪 
                8월 여름방학 마무리 및 2학기 시작 시기에 맞게<strong class="text-gray-800">2학기 내신 공부를 꾸준히 진행해 보세요.</strong>
            </p>
            <div class="flex justify-around text-center text-sm">
                <div>
                    <p class="font-bold text-2xl text-indigo-500">5</p>
                    <p class="text-gray-500">학습 과목</p>
                </div>
                <div>
                    <p class="font-bold text-2xl text-indigo-500">32<span class="text-lg">강</span></p>
                    <p class="text-gray-500">총 수강</p>
                </div>
            </div>
        </section>

        <!-- 2. 과목별 상세 분석 -->
        <h2 class="text-2xl font-bold mb-4 mt-10 text-center text-gray-800">학습 내용 분석</h2>

        <!-- 국어 분석 카드 -->
        <div class="section-card">
            <div class="flex justify-between items-start mb-3">
                <h3 class="text-xl font-bold text-gray-800">📖 국어</h3>
            </div>
            <div class="space-y-4">
                <div>
                    <h4 class="font-semibold text-gray-700">학습 현황</h4>
                    <p class="text-sm text-gray-600 mt-1">
                        <strong class="text-red-500">'일가'</strong>문학 작품을 통해 등장인물 간의 내적/외적 갈등을 학습했습니다. <strong class="text-blue-600">꾸준한 수강의 흐름</strong>을 잘 유지하고 있어요. 😍
                    </p>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-700">AI 학습 제안</h4>
                    <p class="text-sm text-gray-600 mt-1">
                        작품의 내용 뿐만 아니라 <strong class="text-blue-600">소설의 시점과 종류(1인칭,3인칭), 공감적 돋기의 효과와 방법</strong>은 자주 출제되는 포인트이므로, 반드시 잘 정리해 주세요.
                    </p>
                </div>
            </div>
        </div>
        
        <!-- 영어 분석 카드 -->
        <div class="section-card">
            <div class="flex justify-between items-start mb-3">
                <h3 class="text-xl font-bold text-gray-800">🔤 영어</h3>
            </div>
            <div class="space-y-4">
                <div>
                    <h4 class="font-semibold text-gray-700">학습 현황</h4>
                    <p class="text-sm text-gray-600 mt-1">
                        <strong class="text-red-500">'핵심 문법인 목적격 관계대명사'</strong>와 <strong class="text-red-500">'본문 분석'</strong>을 통해 영어의 기본기를 탄탄히 다지고 있습니다. 특히, <strong class="text-red-500">[Top Class] 강의</strong>를 통해 심화 학습까지 도전했어요. 😎
                    </p>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-700">AI 학습 제안</h4>
                    <p class="text-sm text-gray-600 mt-1">
                        <strong class="text-red-500">목적격 관계대명사는</strong> 보통 선행사 뒤에 주어+동사가 바로 오면 생략해도 된다는 점! 알고 있었나요? <strong class="text-blue-600">주격 관계대명사와 함께 정리하는 등의 깊이 있는 문법 공부</strong>를 병행해 주세요.
                    </p>
                </div>
            </div>
        </div>

        <!-- 수학 분석 카드 -->
        <div class="section-card">
            <div class="flex justify-between items-start mb-3">
                <h3 class="text-xl font-bold text-gray-800">🧮 수학</h3>
            </div>
            <div class="space-y-4">
                <div>
                    <h4 class="font-semibold text-gray-700">학습 현황</h4>
                    <p class="text-sm text-gray-600 mt-1">
                        1학기 <strong class="text-red-500">'연립방정식'</strong> 단원 복습을 마치고, 2학기 <strong class="text-red-500">'도형의 성질'</strong> 단원 예습을 시작했습니다. 기말고사 이후에도 남은 1학기 과정을 잘 마무리한 점은 정말 대단합니다.
                    </p>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-700">AI 학습 제안</h4>
                    <p class="text-sm text-gray-600 mt-1">
                        2학년 2학기 수학의 핵심은 <strong class="text-red-500">'도형의 닮음'</strong>입니다. <strong class="text-blue-600">닮음의 조건과 성질을 정확히 이해하고 증명하는 연습</strong>에 집중한다면 2학기 수학을 자신있게 시작할 수 있을 거예요.
                    </p>
                </div>
            </div>
        </div>

        <!-- 과학 분석 카드 -->
        <div class="section-card">
            <div class="flex justify-between items-start mb-3">
                <h3 class="text-xl font-bold text-gray-800">🔬 과학</h3>
            </div>
            <div class="space-y-4">
                <div>
                    <h4 class="font-semibold text-gray-700">학습 현황</h4>
                    <p class="text-sm text-gray-600 mt-1">
                        <strong class="text-red-500">'동물과 에너지'</strong> 단원을 중심으로 2학기 내용을 예습했습니다. 이해가 어려운 개념을 <strong class="text-blue-600">똑똑하게 골라서 공부</strong>하며 자기주도학습 습관을 잘 형성하고 있습니다. 🤗
                    </p>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-700">AI 학습 제안</h4>
                    <p class="text-sm text-gray-600 mt-1">
                        <strong class="text-red-500">'동물과 에너지'</strong> 단원은 <strong class="text-blue-600">소화 → 순환 → 호흡 → 배설을 세포호흡으로 에너지를 얻는 한 흐름</strong>임을 연결해서 이해하는 것이 핵심입니다. 
                    </p>
                </div>
            </div>
        </div>
        
        <!-- 역사 분석 카드 -->
        <div class="section-card">
            <div class="flex justify-between items-start mb-3">
                <h3 class="text-xl font-bold text-gray-800">📜 역사</h3>
            </div>
            <div class="space-y-4">
                <div>
                    <h4 class="font-semibold text-gray-700">학습 현황</h4>
                    <p class="text-sm text-gray-600 mt-1">
                        <strong class="text-red-500">'유럽의 산업화', '제국주의'</strong>까지 2학기 범위를 예습하며 근대 역사 변화의 큰 흐름을 파악했습니다.
                    </p>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-700">AI 학습 제안</h4>
                    <p class="text-sm text-gray-600 mt-1">
                        산업혁명으로 힘이 세진 서양 열강이 아시아·아프리카에 침투해 <strong class="text-blue-600">불평등 조약을 강요, 근대화 추진, 대응으로 독립·민족운동까지</strong> 각 내용의 원인과 배경을 중심으로 공부하면 전체 내용을 이해하는 데 훨씬쉬워요!
                    </p>
                </div>
            </div>
        </div>


        <!-- 3. 시기별 학습 제안 -->
        <h2 class="text-2xl font-bold mb-4 mt-10 text-center text-gray-800">시기별 학습 제안</h2>

        <div class="section-card">
            <!-- 탭 버튼 -->
            <div class="flex justify-center border-b border-gray-200 mb-6">
                <button id="tab-progress-math-btn" class="tab-button active">엠베스트 회원의 수학 진도 분포포표</button>
            </div>

            <!-- 수학 진도 분석 콘텐츠 -->
            <div id="tab-progress-math-content">
                <div class="flex justify-between items-center mb-4">
                    <!-- 범례 -->
                    <div class="flex items-center space-x-4 text-sm">
                        <div class="flex items-center"><span class="w-4 h-4 rounded-full bg-red-500 mr-2"></span> 나의 진도</div>
                        <div class="flex items-center"><span class="w-4 h-4 rounded-sm bg-blue-200 mr-2"></span> 동학년 분포</div>
                        <div class="flex items-center"><span class="w-4 h-4 rounded-sm border-2 border-yellow-500 mr-2"></span> 상위권 주요 분포</div>
                    </div>
                    <!-- 뷰 토글 버튼 -->
                    <div class="flex border border-gray-200 rounded-lg p-0.5">
                        <button id="view-normal-btn" class="toggle-btn active px-3 py-1 text-sm rounded-md">일반</button>
                        <button id="view-top-tier-btn" class="toggle-btn px-3 py-1 text-sm rounded-md">상위권</button>
                    </div>
                </div>

                <!-- 수학 진도 그리드 (JavaScript로 내용 생성) -->
                <div id="math-progress-grid" class="progress-grid">
                    <!-- Grid content will be generated by JavaScript -->
                </div>
                <div class="text-left text-xs text-gray-400 mt-2">
                    *상위권 학생: 특목자사고 합격자 / 목표달성장학생 수강 이력 반영 <br><br><br>
                </div>
                    <!-- AI 추천 강좌 (수학) -->
                    <div class="bg-purple-50 border border-purple-200 rounded-lg p-6 flex flex-col">
                        <h4 class="font-bold text-lg text-purple-800">💡 특목고 합격 선배들의 수학 학습 코스</h4>
                        <div class="flex-grow">
                            <p class="mt-3 text-sm text-purple-700">
                                수강 데이터에 따르면, <strong>특목/자사고에 합격한 선배들은 수학 과목 학습에 있어 현재 진도를 심화 강좌로 복습</strong>했습니다. 심화 강좌가 어렵다면, <strong>개념 강좌와 동시에 함께 듣는</strong> 경우도 많았어요.<br><br>
                                또한 최소 <strong>한 학기 이상 예습</strong>으로 공부했는데요, 특히 학기별 연계성이 강해 다음 학년의 같은 학기 예습을 하기도 했습니다. 예를 들어 2학년 2학기에 3학년 2학기 공부를 함께 한 선배가 많았어요.<br><br>
                            </p>
                        </div>
                    </div>
            </div>
        </div>
    </main>

    <footer class="text-center py-6 text-gray-500 text-sm">
        <p>&copy; 2025 Megastudy. All Rights Reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            
            // --- 시간대별 학습 집중도 라인 차트 렌더링 ---
            // 이 섹션은 삭제되었으므로 관련 JavaScript도 제거합니다.

            // --- 3번 섹션 (진도 분석): 진도 분석 그리드 ---
            const viewNormalBtn = document.getElementById('view-normal-btn');
            const viewTopTierBtn = document.getElementById('view-top-tier-btn');
            const mathGrid = document.getElementById('math-progress-grid');
            
            // 수학 진도 데이터 정의
            const mathData = {
                normal: { // 일반 학생 진도 분포
                    '2-1': { '기본': 0, '발전': 8, '심화': 0 },
                    '2-2': { '기본': 52, '발전': 13, '심화': 0 },
                    '3-1': { '기본': 11, '발전': 9, '심화': 0 },
                    '3-2': { '기본': 8, '발전': 0, '심화': 0 },
                },
                topTier: { // 상위권 학생 진도 분포
                    '2-1': { '기본': 0, '발전': 8, '심화': 0 },
                    '2-2': { '기본': 52, '발전': 13, '심화': 30 }, // 상위권은 심화 진도가 있음
                    '3-1': { '기본': 11, '발전': 9, '심화': 5 },
                    '3-2': { '기본': 8, '발전': 7, '심화': 0 },
                },
                myPosition: { semester: '2-2', level: '기본' }, // 나의 현재 진도 위치
                topTierPath: [ // 상위권 추천 학습 경로 (추가: 2-2 심화)
                    { semester: '2-2', level: '심화' },
                    { semester: '3-1', level: '발전' },
                ],
                tooltips: { // 각 셀에 대한 툴팁 메시지
                    '2-1': { '발전': "메시지 내용" },
                    '2-2': {
                        '기본': "[주요 학습 진도] 삼각형의 성질, 사각형의 성질",
                        '발전': "[주요 학습 진도] 도형의 닮음",
                        '심화': "[주요 학습 진도] 도형의 닮음"
                    },
                    '3-1': {
                        '기본': "[주요 학습 진도] 제곱근과 실수",
                        '발전': "[주요 학습 진도] 다항식, 방정식",
                        '심화': "[주요 학습 진도] 다항식, 방정식"
                    },
                    '3-2': {
                        '기본': "[주요 학습 진도] 삼각비",
                        '발전': "[주요 학습 진도] 삼각비"
                    }
                }
            };

            // 백분율에 따른 배경색 반환 함수
            function getBgColor(percentage) {
                if (percentage > 80) return 'bg-blue-500 text-white';
                if (percentage > 50) return 'bg-blue-400 text-white';
                if (percentage > 30) return 'bg-blue-300';
                if (percentage > 10) return 'bg-blue-200';
                if (percentage > 0) return 'bg-blue-100';
                return 'bg-gray-100';
            }

            /**
             * 수학 진도 그리드를 업데이트하는 함수
             * @param {string} view - 'normal' 또는 'top-tier' 뷰 모드
             */
            function updateMathGrid(view) {
                const isTopTierView = view === 'top-tier';
                
                // '심화' 레벨 행의 표시 여부를 토글 (상위권 뷰에서만 '심화' 행 노출)
                const simhwaRowHeader = mathGrid.querySelector('.grid-header[data-level="심화"]');
                if (simhwaRowHeader) {
                    const simhwaCells = Array.from(mathGrid.querySelectorAll('[data-level="심화"]'));
                    simhwaCells.forEach(cell => {
                        cell.style.display = isTopTierView ? 'flex' : 'none'; // flex로 설정하여 중앙 정렬 유지
                    });
                    simhwaRowHeader.style.display = isTopTierView ? 'flex' : 'none';
                }

                // 각 학기와 레벨에 따라 그리드 셀 업데이트
                ['2-1', '2-2', '3-1', '3-2'].forEach(semester => {
                    ['기본', '발전', '심화'].forEach(level => {
                        const cell = mathGrid.querySelector(`[data-semester="${semester}"][data-level="${level}"]`);
                        if (!cell) return;

                        const data = isTopTierView ? mathData.topTier : mathData.normal;
                        const percentage = data[semester]?.[level] ?? 0;
                        
                        // 기존 클래스 초기화 (grid-cell은 유지)
                        cell.className = 'grid-cell'; 
                        // 백분율에 따른 배경색 클래스 적용
                        if (percentage > 0) {
                            cell.classList.add(...getBgColor(percentage).split(' '));
                        } else {
                            cell.classList.add('bg-gray-100');
                        }

                        // 툴팁 내용 초기화
                        cell.title = ''; 
                        
                        // 나의 현재 위치(ME) 표시 및 백분율 텍스트 설정
                        if (mathData.myPosition.semester === semester && mathData.myPosition.level === level) {
                            // ME 아이콘을 absolute로 배치하고, 백분율 텍스트는 중앙 정렬 유지
                            cell.innerHTML = `
                                <span class="me-icon">ME</span>
                                <span>${percentage}%</span>
                            `;
                            cell.title = "[나의 진도] 현재 이 위치에서 학습하고 있습니다."; // 나의 위치 툴팁 설정
                        } else {
                            // 일반 셀의 텍스트 설정 (0%일 경우 공백 문자)
                            cell.textContent = percentage > 0 ? `${percentage}%` : '\u00A0'; 
                        }
                        
                        // 일반 툴팁 내용 추가 (나의 위치 툴팁이 이미 설정되어 있다면 앞에 추가)
                        if(mathData.tooltips[semester]?.[level]) {
                            if (cell.title.includes('[나의 진도]')) {
                                cell.title = mathData.tooltips[semester][level] + "\n" + cell.title;
                            } else {
                                cell.title = mathData.tooltips[semester][level];
                            }
                        }
                        
                        // 상위권 경로(top-tier-path) 스타일 적용
                        if (isTopTierView && mathData.topTierPath.some(p => p.semester === semester && p.level === level)) {
                            cell.classList.add('top-tier-path');
                        }
                    });
                });
            }

            /**
             * 진도 분석 뷰 모드를 설정하고 그리드를 업데이트하는 함수
             * @param {string} view - 'normal' (일반) 또는 'top-tier' (상위권)
             */
            function setProgressView(view) {
                // 토글 버튼의 활성화/비활성화 상태 변경
                if (view === 'top-tier') {
                    viewNormalBtn.classList.remove('active');
                    viewTopTierBtn.classList.add('active');
                } else {
                    viewTopTierBtn.classList.remove('active');
                    viewNormalBtn.classList.add('active');
                }
                // 그리드 업데이트 함수 호출
                updateMathGrid(view);
            }

            // 토글 버튼 이벤트 리스너 연결
            viewNormalBtn.addEventListener('click', () => setProgressView('normal'));
            viewTopTierBtn.addEventListener('click', () => setProgressView('top-tier'));
            
            // 초기 그리드 HTML 구조 생성 (DOM에 직접 삽입)
            const initialGridHtml = `
                <div class="grid-cell grid-header"></div>
                <div class="grid-cell grid-header">중2-1</div>
                <div class="grid-cell grid-header">중2-2</div>
                <div class="grid-cell grid-header">중3-1</div>
                <div class="grid-cell grid-header">중3-2</div>
                
                <div style="display: contents;">
                    <div class="grid-cell grid-header" data-level="심화">심화</div>
                    <div class="grid-cell" data-semester="2-1" data-level="심화"></div>
                    <div class="grid-cell" data-semester="2-2" data-level="심화"></div>
                    <div class="grid-cell" data-semester="3-1" data-level="심화"></div>
                    <div class="grid-cell" data-semester="3-2" data-level="심화"></div>
                </div>

                <div style="display: contents;">
                    <div class="grid-cell grid-header" data-level="발전">발전</div>
                    <div class="grid-cell" data-semester="2-1" data-level="발전"></div>
                    <div class="grid-cell" data-semester="2-2" data-level="발전"></div>
                    <div class="grid-cell" data-semester="3-1" data-level="발전"></div>
                    <div class="grid-cell" data-semester="3-2" data-level="발전"></div>
                </div>

                <div style="display: contents;">
                    <div class="grid-cell grid-header" data-level="기본">기본</div>
                    <div class="grid-cell" data-semester="2-1" data-level="기본"></div>
                    <div class="grid-cell" data-semester="2-2" data-level="기본"></div>
                    <div class="grid-cell" data-semester="3-1" data-level="기본"></div>
                    <div class="grid-cell" data-semester="3-2" data-level="기본"></div>
                </div>
            `;
            mathGrid.innerHTML = initialGridHtml; // 그리드 HTML 삽입
            setProgressView('normal'); // 초기 뷰를 '일반'으로 설정
        });
    </script>
</body>
</html>
